   1              		.syntax unified
   2              		.cpu cortex-m3
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"guidance_h_ref.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.gh_set_ref,"ax",%progbits
  19              		.align	1
  20              		.global	gh_set_ref
  21              		.thumb
  22              		.thumb_func
  24              	gh_set_ref:
  25              	.LFB0:
  26              		.file 1 "firmwares/rotorcraft/guidance/guidance_h_ref.c"
   1:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /*
   2:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * Copyright (C) 2008-2013 The Paparazzi Team
   3:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
   4:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * This file is part of paparazzi.
   5:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
   6:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * paparazzi is free software; you can redistribute it and/or modify
   7:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * it under the terms of the GNU General Public License as published by
   8:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * the Free Software Foundation; either version 2, or (at your option)
   9:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * any later version.
  10:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
  11:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * paparazzi is distributed in the hope that it will be useful,
  12:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * but WITHOUT ANY WARRANTY; without even the implied warranty of
  13:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  14:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * GNU General Public License for more details.
  15:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
  16:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * You should have received a copy of the GNU General Public License
  17:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * along with paparazzi; see the file COPYING.  If not, write to
  18:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * the Free Software Foundation, 59 Temple Place - Suite 330,
  19:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * Boston, MA 02111-1307, USA.
  20:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  21:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  22:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** @file firmwares/rotorcraft/guidance/guidance_h_ref.c
  23:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *  Reference generation for horizontal guidance.
  24:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  *
  25:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  26:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  27:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #include "firmwares/rotorcraft/guidance/guidance_h_ref.h"
  28:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #include "generated/airframe.h"
  29:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  30:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** Reference model acceleration.
  31:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * in meters/sec2 (output)
  32:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * fixed point representation: Q23.8
  33:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * accuracy 0.0039, range 8388km/s2
  34:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  35:firmwares/rotorcraft/guidance/guidance_h_ref.c **** struct Int32Vect2 gh_accel_ref;
  36:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  37:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** Reference model speed.
  38:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * in meters/sec
  39:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * with fixedpoint representation: Q14.17
  40:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * accuracy 0.0000076 , range 16384m/s
  41:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  42:firmwares/rotorcraft/guidance/guidance_h_ref.c **** struct Int32Vect2 gh_speed_ref;
  43:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  44:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /* Reference model position.
  45:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * in meters
  46:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * with fixedpoint representation: Q37.26
  47:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  48:firmwares/rotorcraft/guidance/guidance_h_ref.c **** struct Int64Vect2 gh_pos_ref;
  49:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  50:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** Accel saturation.
  51:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  * tanf(RadOfDeg(30.))*9.81 = 5.66
  52:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  */
  53:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_MAX_ACCEL
  54:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_MAX_ACCEL 5.66
  55:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  56:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_MAX_ACCEL BFP_OF_REAL(GUIDANCE_H_REF_MAX_ACCEL, GH_ACCEL_REF_FRAC)
  57:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  58:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** Speed saturation */
  59:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_MAX_SPEED
  60:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_MAX_SPEED 5.
  61:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  62:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** @todo GH_MAX_SPEED must be limited to 2^14 to avoid overflow */
  63:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_MAX_SPEED_REF_FRAC 7
  64:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_MAX_SPEED BFP_OF_REAL(GUIDANCE_H_REF_MAX_SPEED, GH_MAX_SPEED_REF_FRAC)
  65:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  66:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** second order model natural frequency */
  67:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_OMEGA
  68:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_OMEGA RadOfDeg(67.)
  69:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  70:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** second order model damping */
  71:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #ifndef GUIDANCE_H_REF_ZETA
  72:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GUIDANCE_H_REF_ZETA  0.85
  73:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #endif
  74:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_ZETA_OMEGA_FRAC 10
  75:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_ZETA_OMEGA BFP_OF_REAL((GUIDANCE_H_REF_ZETA*GUIDANCE_H_REF_OMEGA), GH_ZETA_OMEGA_FRAC)
  76:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_OMEGA_2_FRAC 7
  77:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_OMEGA_2    BFP_OF_REAL((GUIDANCE_H_REF_OMEGA*GUIDANCE_H_REF_OMEGA), GH_OMEGA_2_FRAC)
  78:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  79:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /** first order time constant */
  80:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_REF_THAU_F  0.5
  81:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_REF_INV_THAU_FRAC 16
  82:firmwares/rotorcraft/guidance/guidance_h_ref.c **** #define GH_REF_INV_THAU  BFP_OF_REAL((1./GH_REF_THAU_F), GH_REF_INV_THAU_FRAC)
  83:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  84:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static struct Int32Vect2 gh_max_speed_ref;
  85:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static struct Int32Vect2 gh_max_accel_ref;
  86:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  87:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static int32_t route_ref;
  88:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static int32_t s_route_ref;
  89:firmwares/rotorcraft/guidance/guidance_h_ref.c **** static int32_t c_route_ref;
  90:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
  91:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_set_ref(struct Int32Vect2 pos, struct Int32Vect2 speed, struct Int32Vect2 accel) {
  27              		.loc 1 91 0
  28              		.cfi_startproc
  29              		@ args = 8, pretend = 0, frame = 16
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 24
  34              		.cfi_offset 0, -24
  35              		.cfi_offset 1, -20
  36              		.cfi_offset 2, -16
  37              		.cfi_offset 3, -12
  38              		.cfi_offset 4, -8
  39              		.cfi_offset 14, -4
  40              	.LVL0:
  41              		.loc 1 91 0
  42 0002 04AC     		add	r4, sp, #16
  43 0004 04E90300 		stmdb	r4, {r0, r1}
  44 0008 8DE80C00 		stmia	sp, {r2, r3}
  92:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int64Vect2 new_pos;
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x)<<(GH_POS_REF_FRAC - INT32_POS_FRAC);
  94:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.y = ((int64_t)pos.y)<<(GH_POS_REF_FRAC - INT32_POS_FRAC);
  45              		.loc 1 94 0
  46 000c 039B     		ldr	r3, [sp, #12]
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x)<<(GH_POS_REF_FRAC - INT32_POS_FRAC);
  47              		.loc 1 93 0
  48 000e 029A     		ldr	r2, [sp, #8]
  49              		.loc 1 94 0
  50 0010 D817     		asrs	r0, r3, #31
  51 0012 8404     		lsls	r4, r0, #18
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x)<<(GH_POS_REF_FRAC - INT32_POS_FRAC);
  52              		.loc 1 93 0
  53 0014 D117     		asrs	r1, r2, #31
  54              		.loc 1 94 0
  55 0016 44EA9330 		orr	r0, r4, r3, lsr #14
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x)<<(GH_POS_REF_FRAC - INT32_POS_FRAC);
  56              		.loc 1 93 0
  57 001a 8904     		lsls	r1, r1, #18
  58              		.loc 1 94 0
  59 001c 9C04     		lsls	r4, r3, #18
  60              	.LVL1:
  95:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_pos_ref = new_pos;
  61              		.loc 1 95 0
  62 001e 0B4B     		ldr	r3, .L2
  63              	.LVL2:
  93:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   new_pos.x = ((int64_t)pos.x)<<(GH_POS_REF_FRAC - INT32_POS_FRAC);
  64              		.loc 1 93 0
  65 0020 41EA9231 		orr	r1, r1, r2, lsr #14
  66 0024 9204     		lsls	r2, r2, #18
  67 0026 5960     		str	r1, [r3, #4]
  68 0028 1A60     		str	r2, [r3, #0]
  69              		.loc 1 95 0
  70 002a D860     		str	r0, [r3, #12]
  96:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_speed_ref, speed, (INT32_SPEED_FRAC - GH_SPEED_REF_FRAC));
  71              		.loc 1 96 0
  72 002c 019A     		ldr	r2, [sp, #4]
  95:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_pos_ref = new_pos;
  73              		.loc 1 95 0
  74 002e 9C60     		str	r4, [r3, #8]
  75              		.loc 1 96 0
  76 0030 009B     		ldr	r3, [sp, #0]
  77 0032 0748     		ldr	r0, .L2+4
  78 0034 9910     		asrs	r1, r3, #2
  79 0036 9310     		asrs	r3, r2, #2
  80 0038 0160     		str	r1, [r0, #0]
  81 003a 4360     		str	r3, [r0, #4]
  97:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_accel_ref, accel, (INT32_ACCEL_FRAC - GH_ACCEL_REF_FRAC));
  82              		.loc 1 97 0
  83 003c 0699     		ldr	r1, [sp, #24]
  84 003e 079B     		ldr	r3, [sp, #28]
  85 0040 0448     		ldr	r0, .L2+8
  86 0042 8A10     		asrs	r2, r1, #2
  87 0044 9910     		asrs	r1, r3, #2
  88 0046 0260     		str	r2, [r0, #0]
  89 0048 4160     		str	r1, [r0, #4]
  98:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
  90              		.loc 1 98 0
  91 004a 1FBD     		pop	{r0, r1, r2, r3, r4, pc}
  92              	.L3:
  93              		.align	2
  94              	.L2:
  95 004c 00000000 		.word	.LANCHOR0
  96 0050 00000000 		.word	.LANCHOR1
  97 0054 00000000 		.word	.LANCHOR2
  98              		.cfi_endproc
  99              	.LFE0:
 101              		.global	__aeabi_i2d
 102              		.global	__aeabi_dmul
 103              		.global	__aeabi_d2iz
 104              		.global	__aeabi_i2f
 105              		.global	__aeabi_fmul
 106              		.global	__aeabi_f2iz
 107              		.section	.text.gh_update_ref_from_pos_sp,"ax",%progbits
 108              		.align	1
 109              		.global	gh_update_ref_from_pos_sp
 110              		.thumb
 111              		.thumb_func
 113              	gh_update_ref_from_pos_sp:
 114              	.LFB1:
  99:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 100:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_update_ref_from_pos_sp(struct Int32Vect2 pos_sp) {
 115              		.loc 1 100 0
 116              		.cfi_startproc
 117              		@ args = 0, pretend = 0, frame = 8
 118              		@ frame_needed = 0, uses_anonymous_args = 0
 119 0000 2DE9F341 		push	{r0, r1, r4, r5, r6, r7, r8, lr}
 120              	.LCFI1:
 121              		.cfi_def_cfa_offset 32
 122              		.cfi_offset 0, -32
 123              		.cfi_offset 1, -28
 124              		.cfi_offset 4, -24
 125              		.cfi_offset 5, -20
 126              		.cfi_offset 6, -16
 127              		.cfi_offset 7, -12
 128              		.cfi_offset 8, -8
 129              		.cfi_offset 14, -4
 130              		.loc 1 100 0
 131 0004 02AB     		add	r3, sp, #8
 132 0006 03E90300 		stmdb	r3, {r0, r1}
 101:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 102:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_pos_ref, gh_speed_ref);
 133              		.loc 1 102 0
 134 000a 9949     		ldr	r1, .L44+16
 135 000c 994E     		ldr	r6, .L44+20
 136 000e 0F68     		ldr	r7, [r1, #0]
 137 0010 D1F804E0 		ldr	lr, [r1, #4]
 138 0014 D6E90045 		ldrd	r4, [r6]
 139 0018 E419     		adds	r4, r4, r7
 140 001a 45EBE775 		adc	r5, r5, r7, asr #31
 141 001e D6E90223 		ldrd	r2, [r6, #8]
 142 0022 12EB0E02 		adds	r2, r2, lr
 143 0026 43EBEE73 		adc	r3, r3, lr, asr #31
 144 002a C6E90045 		strd	r4, [r6]
 145 002e C6E90223 		strd	r2, [r6, #8]
 103:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_speed_ref, gh_accel_ref);
 146              		.loc 1 103 0
 147 0032 914E     		ldr	r6, .L44+24
 104:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 105:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute the "speed part" of accel = -2*zeta*omega*speed -omega^2(pos - pos_sp)
 106:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 speed;
 107:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, gh_speed_ref, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 108:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2*GH_ZETA_OMEGA);
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, speed, GH_ZETA_OMEGA_FRAC);
 110:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute pos error in pos_sp resolution
 111:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 pos_err;
 112:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, gh_pos_ref, (GH_POS_REF_FRAC - INT32_POS_FRAC));
 148              		.loc 1 112 0
 149 0034 A40C     		lsrs	r4, r4, #18
 103:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_speed_ref, gh_accel_ref);
 150              		.loc 1 103 0
 151 0036 3068     		ldr	r0, [r6, #0]
 152              		.loc 1 112 0
 153 0038 44EA8534 		orr	r4, r4, r5, lsl #14
 103:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_speed_ref, gh_accel_ref);
 154              		.loc 1 103 0
 155 003c 3818     		adds	r0, r7, r0
 156 003e 7768     		ldr	r7, [r6, #4]
 157              		.loc 1 112 0
 158 0040 950C     		lsrs	r5, r2, #18
 103:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_speed_ref, gh_accel_ref);
 159              		.loc 1 103 0
 160 0042 7744     		add	r7, lr, r7
 161 0044 0860     		str	r0, [r1, #0]
 162 0046 4F60     		str	r7, [r1, #4]
 163              	.LVL3:
 164              		.loc 1 112 0
 165 0048 45EA8335 		orr	r5, r5, r3, lsl #14
 113:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(pos_err, pos_err, pos_sp);
 166              		.loc 1 113 0
 167 004c 0099     		ldr	r1, [sp, #0]
 168 004e 019B     		ldr	r3, [sp, #4]
 108:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2*GH_ZETA_OMEGA);
 169              		.loc 1 108 0
 170 0050 4012     		asrs	r0, r0, #9
 171              	.LVL4:
 172              		.loc 1 113 0
 173 0052 ED1A     		subs	r5, r5, r3
 174 0054 641A     		subs	r4, r4, r1
 175              	.LVL5:
 108:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2*GH_ZETA_OMEGA);
 176              		.loc 1 108 0
 177 0056 FFF7FEFF 		bl	__aeabi_i2d
 178              	.LVL6:
 179 005a 81A3     		adr	r3, .L44
 180 005c D3E90023 		ldrd	r2, [r3]
 181 0060 FFF7FEFF 		bl	__aeabi_dmul
 182              	.LVL7:
 183 0064 FFF7FEFF 		bl	__aeabi_d2iz
 184              	.LVL8:
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, speed, GH_ZETA_OMEGA_FRAC);
 185              		.loc 1 109 0
 186 0068 4FEAA028 		asr	r8, r0, #10
 114:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // convert to accel resolution
 115:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos_err, pos_err, (INT32_POS_FRAC - GH_ACCEL_REF_FRAC));
 116:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute the "pos part" of accel
 117:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 pos;
 118:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, (-GH_OMEGA_2));
 187              		.loc 1 118 0
 188 006c 2046     		mov	r0, r4
 189 006e FFF7FEFF 		bl	__aeabi_i2d
 190              	.LVL9:
 191 0072 7DA3     		adr	r3, .L44+8
 192 0074 D3E90023 		ldrd	r2, [r3]
 193 0078 FFF7FEFF 		bl	__aeabi_dmul
 194              	.LVL10:
 195 007c FFF7FEFF 		bl	__aeabi_d2iz
 196              	.LVL11:
 119:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(pos, pos, GH_OMEGA_2_FRAC);
 120:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // sum accel
 121:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SUM(gh_accel_ref, speed, pos);
 197              		.loc 1 121 0
 198 0080 08EBE010 		add	r0, r8, r0, asr #7
 199 0084 3060     		str	r0, [r6, #0]
 108:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(speed, speed, -2*GH_ZETA_OMEGA);
 200              		.loc 1 108 0
 201 0086 7812     		asrs	r0, r7, #9
 202 0088 FFF7FEFF 		bl	__aeabi_i2d
 203              	.LVL12:
 204 008c 74A3     		adr	r3, .L44
 205 008e D3E90023 		ldrd	r2, [r3]
 206 0092 FFF7FEFF 		bl	__aeabi_dmul
 207              	.LVL13:
 208 0096 FFF7FEFF 		bl	__aeabi_d2iz
 209              	.LVL14:
 109:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed, speed, GH_ZETA_OMEGA_FRAC);
 210              		.loc 1 109 0
 211 009a 8712     		asrs	r7, r0, #10
 212              	.LVL15:
 118:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(pos, pos_err, (-GH_OMEGA_2));
 213              		.loc 1 118 0
 214 009c 2846     		mov	r0, r5
 215 009e FFF7FEFF 		bl	__aeabi_i2d
 216              	.LVL16:
 217 00a2 71A3     		adr	r3, .L44+8
 218 00a4 D3E90023 		ldrd	r2, [r3]
 219 00a8 FFF7FEFF 		bl	__aeabi_dmul
 220              	.LVL17:
 221 00ac FFF7FEFF 		bl	__aeabi_d2iz
 222              	.LVL18:
 223              		.loc 1 121 0
 224 00b0 07EBE010 		add	r0, r7, r0, asr #7
 225 00b4 7060     		str	r0, [r6, #4]
 122:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 123:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute route reference before saturation */
 124:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   float f_route_ref = atan2f(-pos_err.y, -pos_err.x);
 226              		.loc 1 124 0
 227 00b6 6842     		negs	r0, r5
 228 00b8 FFF7FEFF 		bl	__aeabi_i2f
 229              	.LVL19:
 230 00bc 0546     		mov	r5, r0
 231              	.LVL20:
 232 00be 6042     		negs	r0, r4
 233 00c0 FFF7FEFF 		bl	__aeabi_i2f
 234              	.LVL21:
 235 00c4 0146     		mov	r1, r0
 236 00c6 2846     		mov	r0, r5
 237 00c8 FFF7FEFF 		bl	atan2f
 238              	.LVL22:
 125:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   route_ref = ANGLE_BFP_OF_REAL(f_route_ref);
 239              		.loc 1 125 0
 240 00cc 4FF08B41 		mov	r1, #1166016512
 241 00d0 FFF7FEFF 		bl	__aeabi_fmul
 242              	.LVL23:
 243 00d4 FFF7FEFF 		bl	__aeabi_f2iz
 244              	.LVL24:
 245 00d8 684B     		ldr	r3, .L44+28
 246 00da 1860     		str	r0, [r3, #0]
 247              	.LVL25:
 248              	.LBB2:
 126:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute North and East route components */
 127:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_SIN(s_route_ref, route_ref);
 249              		.loc 1 127 0
 250 00dc 0346     		mov	r3, r0
 251              	.LVL26:
 252              	.L5:
 253              		.loc 1 127 0 is_stmt 0 discriminator 1
 254 00de 43F24322 		movw	r2, #12867
 255 00e2 9342     		cmp	r3, r2
 256 00e4 03DD     		ble	.L35
 257              	.L6:
 258              		.loc 1 127 0 discriminator 2
 259 00e6 A3F5C943 		sub	r3, r3, #25728
 260              	.LVL27:
 261 00ea 073B     		subs	r3, r3, #7
 262              	.LVL28:
 263 00ec F7E7     		b	.L5
 264              	.LVL29:
 265              	.L35:
 266              		.loc 1 127 0 discriminator 4
 267 00ee 6449     		ldr	r1, .L44+32
 268 00f0 8B42     		cmp	r3, r1
 269 00f2 03DA     		bge	.L42
 270              	.L8:
 271              		.loc 1 127 0 discriminator 5
 272 00f4 03F5C944 		add	r4, r3, #25728
 273 00f8 E31D     		adds	r3, r4, #7
 274              	.LVL30:
 275 00fa F8E7     		b	.L35
 276              	.LVL31:
 277              	.L42:
 278              		.loc 1 127 0 discriminator 6
 279 00fc 41F62114 		movw	r4, #6433
 280 0100 A342     		cmp	r3, r4
 281 0102 604D     		ldr	r5, .L44+36
 282 0104 604E     		ldr	r6, .L44+40
 283 0106 03DD     		ble	.L9
 284              		.loc 1 127 0 discriminator 7
 285 0108 C3F54953 		rsb	r3, r3, #12864
 286              	.LVL32:
 287 010c 0333     		adds	r3, r3, #3
 288              	.LVL33:
 289 010e 0CE0     		b	.L10
 290              	.L9:
 291              		.loc 1 127 0 discriminator 8
 292 0110 6FF4C952 		mvn	r2, #6432
 293 0114 9342     		cmp	r3, r2
 294 0116 06DA     		bge	.L11
 295              		.loc 1 127 0 discriminator 9
 296 0118 C3F17F43 		rsb	r3, r3, #-16777216
 297              	.LVL34:
 298 011c 03F57F01 		add	r1, r3, #16711680
 299 0120 01F54D43 		add	r3, r1, #52480
 300 0124 BD33     		adds	r3, r3, #189
 301              	.LVL35:
 302              	.L11:
 303              		.loc 1 127 0 discriminator 10
 304 0126 002B     		cmp	r3, #0
 305 0128 02DB     		blt	.L12
 306              	.L10:
 307              		.loc 1 127 0 discriminator 11
 308 012a 36F91320 		ldrsh	r2, [r6, r3, lsl #1]
 309 012e 03E0     		b	.L37
 310              	.L12:
 311              		.loc 1 127 0 discriminator 12
 312 0130 5C42     		negs	r4, r3
 313 0132 36F91460 		ldrsh	r6, [r6, r4, lsl #1]
 314 0136 7242     		negs	r2, r6
 315              	.L37:
 316              	.LBE2:
 317              	.LBB3:
 128:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_COS(c_route_ref, route_ref);
 318              		.loc 1 128 0 is_stmt 1 discriminator 12
 319 0138 00F5C950 		add	r0, r0, #6432
 320              	.LBE3:
 321              	.LBB4:
 127:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_SIN(s_route_ref, route_ref);
 322              		.loc 1 127 0 discriminator 12
 323 013c 2A60     		str	r2, [r5, #0]
 324              	.LBE4:
 325              	.LBB5:
 326              		.loc 1 128 0 discriminator 12
 327 013e 0130     		adds	r0, r0, #1
 328              	.LVL36:
 329              	.L14:
 330              		.loc 1 128 0 is_stmt 0 discriminator 1
 331 0140 43F24325 		movw	r5, #12867
 332 0144 A842     		cmp	r0, r5
 333 0146 03DD     		ble	.L36
 334              	.L15:
 335              		.loc 1 128 0 discriminator 2
 336 0148 A0F5C945 		sub	r5, r0, #25728
 337 014c E81F     		subs	r0, r5, #7
 338              	.LVL37:
 339 014e F7E7     		b	.L14
 340              	.LVL38:
 341              	.L36:
 342              		.loc 1 128 0 discriminator 4
 343 0150 4B49     		ldr	r1, .L44+32
 344 0152 8842     		cmp	r0, r1
 345 0154 03DA     		bge	.L43
 346              	.L17:
 347              		.loc 1 128 0 discriminator 5
 348 0156 00F5C946 		add	r6, r0, #25728
 349 015a F01D     		adds	r0, r6, #7
 350              	.LVL39:
 351 015c F8E7     		b	.L36
 352              	.LVL40:
 353              	.L43:
 354              		.loc 1 128 0 discriminator 6
 355 015e 41F62114 		movw	r4, #6433
 356 0162 A042     		cmp	r0, r4
 357 0164 484E     		ldr	r6, .L44+40
 358 0166 494B     		ldr	r3, .L44+44
 359              	.LVL41:
 360 0168 03DD     		ble	.L18
 361              		.loc 1 128 0 discriminator 7
 362 016a C0F54952 		rsb	r2, r0, #12864
 363 016e D01C     		adds	r0, r2, #3
 364              	.LVL42:
 365 0170 0CE0     		b	.L19
 366              	.L18:
 367              		.loc 1 128 0 discriminator 8
 368 0172 6FF4C952 		mvn	r2, #6432
 369 0176 9042     		cmp	r0, r2
 370 0178 06DA     		bge	.L20
 371              		.loc 1 128 0 discriminator 9
 372 017a C0F17F40 		rsb	r0, r0, #-16777216
 373              	.LVL43:
 374 017e 00F57F05 		add	r5, r0, #16711680
 375 0182 05F54D40 		add	r0, r5, #52480
 376 0186 BD30     		adds	r0, r0, #189
 377              	.LVL44:
 378              	.L20:
 379              		.loc 1 128 0 discriminator 10
 380 0188 0028     		cmp	r0, #0
 381 018a 02DB     		blt	.L21
 382              	.L19:
 383              		.loc 1 128 0 discriminator 11
 384 018c 36F91060 		ldrsh	r6, [r6, r0, lsl #1]
 385 0190 03E0     		b	.L38
 386              	.L21:
 387              		.loc 1 128 0 discriminator 12
 388 0192 4142     		negs	r1, r0
 389 0194 36F91140 		ldrsh	r4, [r6, r1, lsl #1]
 390 0198 6642     		negs	r6, r4
 391              	.L38:
 392 019a 1E60     		str	r6, [r3, #0]
 393              	.LBE5:
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   c_route_ref = abs(c_route_ref);
 394              		.loc 1 129 0 is_stmt 1 discriminator 12
 395 019c 3B4B     		ldr	r3, .L44+44
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 396              		.loc 1 130 0 discriminator 12
 397 019e 394D     		ldr	r5, .L44+36
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   c_route_ref = abs(c_route_ref);
 398              		.loc 1 129 0 discriminator 12
 399 01a0 1E68     		ldr	r6, [r3, #0]
 131:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute maximum acceleration*/
 132:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, c_route_ref, INT32_TRIG_FRAC);
 400              		.loc 1 132 0 discriminator 12
 401 01a2 4FF4B561 		mov	r1, #1448
 129:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   c_route_ref = abs(c_route_ref);
 402              		.loc 1 129 0 discriminator 12
 403 01a6 002E     		cmp	r6, #0
 404 01a8 B8BF     		it	lt
 405 01aa 7642     		rsblt	r6, r6, #0
 406 01ac 1E60     		str	r6, [r3, #0]
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 407              		.loc 1 130 0 discriminator 12
 408 01ae 2B68     		ldr	r3, [r5, #0]
 409              		.loc 1 132 0 discriminator 12
 410 01b0 01FB06F0 		mul	r0, r1, r6
 411              	.LVL45:
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 412              		.loc 1 130 0 discriminator 12
 413 01b4 002B     		cmp	r3, #0
 414 01b6 B8BF     		it	lt
 415 01b8 5B42     		rsblt	r3, r3, #0
 133:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, s_route_ref, INT32_TRIG_FRAC);
 416              		.loc 1 133 0 discriminator 12
 417 01ba 5943     		muls	r1, r3, r1
 130:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 418              		.loc 1 130 0 discriminator 12
 419 01bc 2B60     		str	r3, [r5, #0]
 134:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute maximum speed*/
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, c_route_ref, INT32_TRIG_FRAC);
 420              		.loc 1 135 0 discriminator 12
 421 01be 4FF42075 		mov	r5, #640
 422 01c2 6E43     		muls	r6, r5, r6
 136:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, s_route_ref, INT32_TRIG_FRAC);
 423              		.loc 1 136 0 discriminator 12
 424 01c4 6B43     		muls	r3, r5, r3
 132:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, c_route_ref, INT32_TRIG_FRAC);
 425              		.loc 1 132 0 discriminator 12
 426 01c6 324C     		ldr	r4, .L44+48
 427 01c8 8013     		asrs	r0, r0, #14
 133:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, s_route_ref, INT32_TRIG_FRAC);
 428              		.loc 1 133 0 discriminator 12
 429 01ca 8913     		asrs	r1, r1, #14
 132:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, c_route_ref, INT32_TRIG_FRAC);
 430              		.loc 1 132 0 discriminator 12
 431 01cc 2060     		str	r0, [r4, #0]
 133:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, s_route_ref, INT32_TRIG_FRAC);
 432              		.loc 1 133 0 discriminator 12
 433 01ce 6160     		str	r1, [r4, #4]
 137:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* restore gh_speed_ref range (Q14.17) */
 138:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_max_speed_ref, gh_max_speed_ref, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC
 139:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 140:firmwares/rotorcraft/guidance/guidance_h_ref.c ****  /* Saturate accelerations */
 141:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_accel_ref.x <= -gh_max_accel_ref.x) {
 434              		.loc 1 141 0 discriminator 12
 435 01d0 294C     		ldr	r4, .L44+24
 135:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, c_route_ref, INT32_TRIG_FRAC);
 436              		.loc 1 135 0 discriminator 12
 437 01d2 B213     		asrs	r2, r6, #14
 136:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, s_route_ref, INT32_TRIG_FRAC);
 438              		.loc 1 136 0 discriminator 12
 439 01d4 9B13     		asrs	r3, r3, #14
 138:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_max_speed_ref, gh_max_speed_ref, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC
 440              		.loc 1 138 0 discriminator 12
 441 01d6 2F4E     		ldr	r6, .L44+52
 442 01d8 9202     		lsls	r2, r2, #10
 443 01da 9B02     		lsls	r3, r3, #10
 444              		.loc 1 141 0 discriminator 12
 445 01dc 2568     		ldr	r5, [r4, #0]
 138:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_max_speed_ref, gh_max_speed_ref, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC
 446              		.loc 1 138 0 discriminator 12
 447 01de 3260     		str	r2, [r6, #0]
 448 01e0 7360     		str	r3, [r6, #4]
 449              		.loc 1 141 0 discriminator 12
 450 01e2 4642     		negs	r6, r0
 451 01e4 B542     		cmp	r5, r6
 452 01e6 01DC     		bgt	.L23
 142:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.x = -gh_max_accel_ref.x;
 453              		.loc 1 142 0
 454 01e8 2660     		str	r6, [r4, #0]
 455 01ea 02E0     		b	.L24
 456              	.L23:
 143:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 144:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_accel_ref.x >=  gh_max_accel_ref.x) {
 457              		.loc 1 144 0
 458 01ec 8542     		cmp	r5, r0
 145:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.x =  gh_max_accel_ref.x;
 459              		.loc 1 145 0
 460 01ee A8BF     		it	ge
 461 01f0 2060     		strge	r0, [r4, #0]
 462              	.L24:
 146:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 147:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_accel_ref.y <= -gh_max_accel_ref.y) {
 463              		.loc 1 147 0
 464 01f2 6468     		ldr	r4, [r4, #4]
 465 01f4 4D42     		negs	r5, r1
 466 01f6 AC42     		cmp	r4, r5
 467 01f8 1F48     		ldr	r0, .L44+24
 468 01fa 01DC     		bgt	.L25
 148:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.y = -gh_max_accel_ref.y;
 469              		.loc 1 148 0
 470 01fc 4560     		str	r5, [r0, #4]
 471 01fe 02E0     		b	.L26
 472              	.L25:
 149:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 150:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_accel_ref.y >= gh_max_accel_ref.y) {
 473              		.loc 1 150 0
 474 0200 8C42     		cmp	r4, r1
 151:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.y = gh_max_accel_ref.y;
 475              		.loc 1 151 0
 476 0202 A8BF     		it	ge
 477 0204 4160     		strge	r1, [r0, #4]
 478              	.L26:
 152:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 153:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 154:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Saturate speed and adjust acceleration accordingly */
 155:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_speed_ref.x <= -gh_max_speed_ref.x) {
 479              		.loc 1 155 0
 480 0206 1A49     		ldr	r1, .L44+16
 481 0208 5442     		negs	r4, r2
 482 020a 0868     		ldr	r0, [r1, #0]
 483 020c A042     		cmp	r0, r4
 484 020e 05DC     		bgt	.L27
 156:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.x = -gh_max_speed_ref.x;
 157:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.x < 0)
 485              		.loc 1 157 0
 486 0210 194A     		ldr	r2, .L44+24
 156:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.x = -gh_max_speed_ref.x;
 487              		.loc 1 156 0
 488 0212 0C60     		str	r4, [r1, #0]
 489              		.loc 1 157 0
 490 0214 1068     		ldr	r0, [r2, #0]
 491 0216 0028     		cmp	r0, #0
 492 0218 09DA     		bge	.L29
 493 021a 06E0     		b	.L39
 494              	.L27:
 158:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.x = 0;
 159:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 160:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_speed_ref.x >=  gh_max_speed_ref.x) {
 495              		.loc 1 160 0
 496 021c 9042     		cmp	r0, r2
 497 021e 06DB     		blt	.L29
 161:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.x =  gh_max_speed_ref.x;
 498              		.loc 1 161 0
 499 0220 0A60     		str	r2, [r1, #0]
 162:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.x > 0)
 500              		.loc 1 162 0
 501 0222 154A     		ldr	r2, .L44+24
 502 0224 1068     		ldr	r0, [r2, #0]
 503 0226 0028     		cmp	r0, #0
 504 0228 01DD     		ble	.L29
 505              	.L39:
 163:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.x = 0;
 506              		.loc 1 163 0
 507 022a 0020     		movs	r0, #0
 508 022c 1060     		str	r0, [r2, #0]
 509              	.L29:
 164:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 165:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_speed_ref.y <= -gh_max_speed_ref.y) {
 510              		.loc 1 165 0
 511 022e 4968     		ldr	r1, [r1, #4]
 512 0230 5842     		negs	r0, r3
 513 0232 8142     		cmp	r1, r0
 514 0234 0E4A     		ldr	r2, .L44+16
 515 0236 05DC     		bgt	.L31
 166:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.y = -gh_max_speed_ref.y;
 167:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.y < 0)
 516              		.loc 1 167 0
 517 0238 0F4B     		ldr	r3, .L44+24
 166:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.y = -gh_max_speed_ref.y;
 518              		.loc 1 166 0
 519 023a 5060     		str	r0, [r2, #4]
 520              		.loc 1 167 0
 521 023c 5968     		ldr	r1, [r3, #4]
 522 023e 0029     		cmp	r1, #0
 523 0240 09DA     		bge	.L4
 524 0242 06E0     		b	.L40
 525              	.L31:
 168:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.y = 0;
 169:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 170:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_speed_ref.y >= gh_max_speed_ref.y) {
 526              		.loc 1 170 0
 527 0244 9942     		cmp	r1, r3
 528 0246 06DB     		blt	.L4
 171:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.y = gh_max_speed_ref.y;
 529              		.loc 1 171 0
 530 0248 5360     		str	r3, [r2, #4]
 172:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.y > 0)
 531              		.loc 1 172 0
 532 024a 0B4B     		ldr	r3, .L44+24
 533 024c 5A68     		ldr	r2, [r3, #4]
 534 024e 002A     		cmp	r2, #0
 535 0250 01DD     		ble	.L4
 536              	.L40:
 173:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.y = 0;
 537              		.loc 1 173 0
 538 0252 0020     		movs	r0, #0
 539 0254 5860     		str	r0, [r3, #4]
 540              	.L4:
 174:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 175:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 541              		.loc 1 175 0
 542 0256 BDE8FC81 		pop	{r2, r3, r4, r5, r6, r7, r8, pc}
 543              	.L45:
 544 025a 00BFAFF3 		.align	3
 544      0080
 545              	.L44:
 546 0260 353AE2B4 		.word	3034724917
 547 0264 8FCE9FC0 		.word	-1063268721
 548 0268 053EA9C2 		.word	3265871365
 549 026c FBE065C0 		.word	-1067065093
 550 0270 00000000 		.word	.LANCHOR1
 551 0274 00000000 		.word	.LANCHOR0
 552 0278 00000000 		.word	.LANCHOR2
 553 027c 00000000 		.word	.LANCHOR3
 554 0280 BDCDFFFF 		.word	-12867
 555 0284 00000000 		.word	.LANCHOR4
 556 0288 00000000 		.word	pprz_trig_int
 557 028c 00000000 		.word	.LANCHOR5
 558 0290 00000000 		.word	.LANCHOR6
 559 0294 00000000 		.word	.LANCHOR7
 560              		.cfi_endproc
 561              	.LFE1:
 563              		.section	.text.gh_update_ref_from_speed_sp,"ax",%progbits
 564              		.align	1
 565              		.global	gh_update_ref_from_speed_sp
 566              		.thumb
 567              		.thumb_func
 569              	gh_update_ref_from_speed_sp:
 570              	.LFB2:
 176:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 177:firmwares/rotorcraft/guidance/guidance_h_ref.c **** void gh_update_ref_from_speed_sp(struct Int32Vect2 speed_sp) {
 571              		.loc 1 177 0
 572              		.cfi_startproc
 573              		@ args = 0, pretend = 0, frame = 8
 574              		@ frame_needed = 0, uses_anonymous_args = 0
 575 0000 F7B5     		push	{r0, r1, r2, r4, r5, r6, r7, lr}
 576              	.LCFI2:
 577              		.cfi_def_cfa_offset 32
 578              		.cfi_offset 0, -32
 579              		.cfi_offset 1, -28
 580              		.cfi_offset 2, -24
 581              		.cfi_offset 4, -20
 582              		.cfi_offset 5, -16
 583              		.cfi_offset 6, -12
 584              		.cfi_offset 7, -8
 585              		.cfi_offset 14, -4
 586              		.loc 1 177 0
 587 0002 02AB     		add	r3, sp, #8
 588 0004 03E90300 		stmdb	r3, {r0, r1}
 178:firmwares/rotorcraft/guidance/guidance_h_ref.c **** /* WARNING: SPEED SATURATION UNTESTED */
 179:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_pos_ref, gh_speed_ref);
 589              		.loc 1 179 0
 590 0008 8449     		ldr	r1, .L85
 591 000a 8548     		ldr	r0, .L85+4
 592 000c 0F68     		ldr	r7, [r1, #0]
 593 000e D1F804E0 		ldr	lr, [r1, #4]
 594 0012 D0E90023 		ldrd	r2, [r0]
 595 0016 D219     		adds	r2, r2, r7
 596 0018 43EBE773 		adc	r3, r3, r7, asr #31
 180:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_speed_ref, gh_accel_ref);
 597              		.loc 1 180 0
 598 001c 814E     		ldr	r6, .L85+8
 179:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_pos_ref, gh_speed_ref);
 599              		.loc 1 179 0
 600 001e C0E90023 		strd	r2, [r0]
 601 0022 D0E90223 		ldrd	r2, [r0, #8]
 602 0026 12EB0E02 		adds	r2, r2, lr
 603 002a 43EBEE73 		adc	r3, r3, lr, asr #31
 604 002e C0E90223 		strd	r2, [r0, #8]
 605              		.loc 1 180 0
 606 0032 3068     		ldr	r0, [r6, #0]
 607 0034 009D     		ldr	r5, [sp, #0]
 608              	.LVL46:
 609 0036 3818     		adds	r0, r7, r0
 610 0038 7768     		ldr	r7, [r6, #4]
 611 003a 0860     		str	r0, [r1, #0]
 612 003c 7744     		add	r7, lr, r7
 181:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 182:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute speed error
 183:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   struct Int32Vect2 speed_err;
 184:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_sp, (INT32_SPEED_FRAC - GH_SPEED_REF_FRAC));
 185:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(speed_err, gh_speed_ref, speed_err);
 613              		.loc 1 185 0
 614 003e A0EBA500 		sub	r0, r0, r5, asr #2
 180:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_ADD(gh_speed_ref, gh_accel_ref);
 615              		.loc 1 180 0
 616 0042 4F60     		str	r7, [r1, #4]
 186:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // convert to accel resolution
 187:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(speed_err, speed_err, (GH_SPEED_REF_FRAC - GH_ACCEL_REF_FRAC));
 188:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   // compute accel from speed_sp
 189:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(gh_accel_ref, speed_err, -GH_REF_INV_THAU);
 617              		.loc 1 189 0
 618 0044 4012     		asrs	r0, r0, #9
 619 0046 FFF7FEFF 		bl	__aeabi_i2d
 620              	.LVL47:
 621 004a 0022     		movs	r2, #0
 622 004c 4FF04143 		mov	r3, #-1056964608
 623 0050 FFF7FEFF 		bl	__aeabi_dmul
 624              	.LVL48:
 625 0054 FFF7FEFF 		bl	__aeabi_d2iz
 626              	.LVL49:
 627 0058 019C     		ldr	r4, [sp, #4]
 628              	.LVL50:
 190:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_RSHIFT(gh_accel_ref, gh_accel_ref, GH_REF_INV_THAU_FRAC);
 629              		.loc 1 190 0
 630 005a 0014     		asrs	r0, r0, #16
 631 005c 3060     		str	r0, [r6, #0]
 185:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_DIFF(speed_err, gh_speed_ref, speed_err);
 632              		.loc 1 185 0
 633 005e A7EBA400 		sub	r0, r7, r4, asr #2
 189:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   VECT2_SMUL(gh_accel_ref, speed_err, -GH_REF_INV_THAU);
 634              		.loc 1 189 0
 635 0062 4012     		asrs	r0, r0, #9
 636              	.LVL51:
 637 0064 FFF7FEFF 		bl	__aeabi_i2d
 638              	.LVL52:
 639 0068 4FF04143 		mov	r3, #-1056964608
 640 006c 0022     		movs	r2, #0
 641 006e FFF7FEFF 		bl	__aeabi_dmul
 642              	.LVL53:
 643 0072 FFF7FEFF 		bl	__aeabi_d2iz
 644              	.LVL54:
 645              		.loc 1 190 0
 646 0076 0014     		asrs	r0, r0, #16
 647 0078 7060     		str	r0, [r6, #4]
 191:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 192:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute route reference before saturation */
 193:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   float f_route_ref = atan2f(-speed_sp.y, -speed_sp.x);
 648              		.loc 1 193 0
 649 007a 6042     		negs	r0, r4
 650 007c FFF7FEFF 		bl	__aeabi_i2f
 651              	.LVL55:
 652 0080 0446     		mov	r4, r0
 653              	.LVL56:
 654 0082 6842     		negs	r0, r5
 655 0084 FFF7FEFF 		bl	__aeabi_i2f
 656              	.LVL57:
 657 0088 0146     		mov	r1, r0
 658 008a 2046     		mov	r0, r4
 659 008c FFF7FEFF 		bl	atan2f
 660              	.LVL58:
 194:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   route_ref = ANGLE_BFP_OF_REAL(f_route_ref);
 661              		.loc 1 194 0
 662 0090 4FF08B41 		mov	r1, #1166016512
 663 0094 FFF7FEFF 		bl	__aeabi_fmul
 664              	.LVL59:
 665 0098 FFF7FEFF 		bl	__aeabi_f2iz
 666              	.LVL60:
 667 009c 624B     		ldr	r3, .L85+12
 668 009e 1860     		str	r0, [r3, #0]
 669              	.LVL61:
 670              	.LBB6:
 195:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute North and East route components */
 196:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_SIN(s_route_ref, route_ref);
 671              		.loc 1 196 0
 672 00a0 0346     		mov	r3, r0
 673              	.LVL62:
 674              	.L47:
 675              		.loc 1 196 0 is_stmt 0 discriminator 1
 676 00a2 43F24322 		movw	r2, #12867
 677 00a6 9342     		cmp	r3, r2
 678 00a8 03DD     		ble	.L77
 679              	.L48:
 680              		.loc 1 196 0 discriminator 2
 681 00aa A3F5C943 		sub	r3, r3, #25728
 682              	.LVL63:
 683 00ae 073B     		subs	r3, r3, #7
 684              	.LVL64:
 685 00b0 F7E7     		b	.L47
 686              	.LVL65:
 687              	.L77:
 688              		.loc 1 196 0 discriminator 4
 689 00b2 5E49     		ldr	r1, .L85+16
 690 00b4 8B42     		cmp	r3, r1
 691 00b6 03DA     		bge	.L83
 692              	.L50:
 693              		.loc 1 196 0 discriminator 5
 694 00b8 03F5C944 		add	r4, r3, #25728
 695 00bc E31D     		adds	r3, r4, #7
 696              	.LVL66:
 697 00be F8E7     		b	.L77
 698              	.LVL67:
 699              	.L83:
 700              		.loc 1 196 0 discriminator 6
 701 00c0 41F62114 		movw	r4, #6433
 702 00c4 A342     		cmp	r3, r4
 703 00c6 5A4D     		ldr	r5, .L85+20
 704              	.LVL68:
 705 00c8 5A4E     		ldr	r6, .L85+24
 706 00ca 03DD     		ble	.L51
 707              		.loc 1 196 0 discriminator 7
 708 00cc C3F54953 		rsb	r3, r3, #12864
 709              	.LVL69:
 710 00d0 0333     		adds	r3, r3, #3
 711              	.LVL70:
 712 00d2 0CE0     		b	.L52
 713              	.L51:
 714              		.loc 1 196 0 discriminator 8
 715 00d4 6FF4C952 		mvn	r2, #6432
 716 00d8 9342     		cmp	r3, r2
 717 00da 06DA     		bge	.L53
 718              		.loc 1 196 0 discriminator 9
 719 00dc C3F17F43 		rsb	r3, r3, #-16777216
 720              	.LVL71:
 721 00e0 03F57F01 		add	r1, r3, #16711680
 722 00e4 01F54D43 		add	r3, r1, #52480
 723 00e8 BD33     		adds	r3, r3, #189
 724              	.LVL72:
 725              	.L53:
 726              		.loc 1 196 0 discriminator 10
 727 00ea 002B     		cmp	r3, #0
 728 00ec 02DB     		blt	.L54
 729              	.L52:
 730              		.loc 1 196 0 discriminator 11
 731 00ee 36F91320 		ldrsh	r2, [r6, r3, lsl #1]
 732 00f2 03E0     		b	.L79
 733              	.L54:
 734              		.loc 1 196 0 discriminator 12
 735 00f4 5C42     		negs	r4, r3
 736 00f6 36F91460 		ldrsh	r6, [r6, r4, lsl #1]
 737 00fa 7242     		negs	r2, r6
 738              	.L79:
 739              	.LBE6:
 740              	.LBB7:
 197:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_COS(c_route_ref, route_ref);
 741              		.loc 1 197 0 is_stmt 1 discriminator 12
 742 00fc 00F5C950 		add	r0, r0, #6432
 743              	.LBE7:
 744              	.LBB8:
 196:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   PPRZ_ITRIG_SIN(s_route_ref, route_ref);
 745              		.loc 1 196 0 discriminator 12
 746 0100 2A60     		str	r2, [r5, #0]
 747              	.LBE8:
 748              	.LBB9:
 749              		.loc 1 197 0 discriminator 12
 750 0102 0130     		adds	r0, r0, #1
 751              	.LVL73:
 752              	.L56:
 753              		.loc 1 197 0 is_stmt 0 discriminator 1
 754 0104 43F24325 		movw	r5, #12867
 755 0108 A842     		cmp	r0, r5
 756 010a 03DD     		ble	.L78
 757              	.L57:
 758              		.loc 1 197 0 discriminator 2
 759 010c A0F5C945 		sub	r5, r0, #25728
 760 0110 E81F     		subs	r0, r5, #7
 761              	.LVL74:
 762 0112 F7E7     		b	.L56
 763              	.LVL75:
 764              	.L78:
 765              		.loc 1 197 0 discriminator 4
 766 0114 4549     		ldr	r1, .L85+16
 767 0116 8842     		cmp	r0, r1
 768 0118 03DA     		bge	.L84
 769              	.L59:
 770              		.loc 1 197 0 discriminator 5
 771 011a 00F5C946 		add	r6, r0, #25728
 772 011e F01D     		adds	r0, r6, #7
 773              	.LVL76:
 774 0120 F8E7     		b	.L78
 775              	.LVL77:
 776              	.L84:
 777              		.loc 1 197 0 discriminator 6
 778 0122 41F62114 		movw	r4, #6433
 779 0126 A042     		cmp	r0, r4
 780 0128 424E     		ldr	r6, .L85+24
 781 012a 434B     		ldr	r3, .L85+28
 782              	.LVL78:
 783 012c 03DD     		ble	.L60
 784              		.loc 1 197 0 discriminator 7
 785 012e C0F54952 		rsb	r2, r0, #12864
 786 0132 D01C     		adds	r0, r2, #3
 787              	.LVL79:
 788 0134 0CE0     		b	.L61
 789              	.L60:
 790              		.loc 1 197 0 discriminator 8
 791 0136 6FF4C952 		mvn	r2, #6432
 792 013a 9042     		cmp	r0, r2
 793 013c 06DA     		bge	.L62
 794              		.loc 1 197 0 discriminator 9
 795 013e C0F17F40 		rsb	r0, r0, #-16777216
 796              	.LVL80:
 797 0142 00F57F05 		add	r5, r0, #16711680
 798 0146 05F54D40 		add	r0, r5, #52480
 799 014a BD30     		adds	r0, r0, #189
 800              	.LVL81:
 801              	.L62:
 802              		.loc 1 197 0 discriminator 10
 803 014c 0028     		cmp	r0, #0
 804 014e 02DB     		blt	.L63
 805              	.L61:
 806              		.loc 1 197 0 discriminator 11
 807 0150 36F91060 		ldrsh	r6, [r6, r0, lsl #1]
 808 0154 03E0     		b	.L80
 809              	.L63:
 810              		.loc 1 197 0 discriminator 12
 811 0156 4142     		negs	r1, r0
 812 0158 36F91140 		ldrsh	r4, [r6, r1, lsl #1]
 813 015c 6642     		negs	r6, r4
 814              	.L80:
 815 015e 1E60     		str	r6, [r3, #0]
 816              	.LBE9:
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   c_route_ref = abs(c_route_ref);
 817              		.loc 1 198 0 is_stmt 1 discriminator 12
 818 0160 354B     		ldr	r3, .L85+28
 199:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 819              		.loc 1 199 0 discriminator 12
 820 0162 334D     		ldr	r5, .L85+20
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   c_route_ref = abs(c_route_ref);
 821              		.loc 1 198 0 discriminator 12
 822 0164 1E68     		ldr	r6, [r3, #0]
 200:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute maximum acceleration*/
 201:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, c_route_ref, INT32_TRIG_FRAC);
 823              		.loc 1 201 0 discriminator 12
 824 0166 4FF4B561 		mov	r1, #1448
 198:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   c_route_ref = abs(c_route_ref);
 825              		.loc 1 198 0 discriminator 12
 826 016a 002E     		cmp	r6, #0
 827 016c B8BF     		it	lt
 828 016e 7642     		rsblt	r6, r6, #0
 829 0170 1E60     		str	r6, [r3, #0]
 199:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 830              		.loc 1 199 0 discriminator 12
 831 0172 2B68     		ldr	r3, [r5, #0]
 832              		.loc 1 201 0 discriminator 12
 833 0174 01FB06F0 		mul	r0, r1, r6
 834              	.LVL82:
 199:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 835              		.loc 1 199 0 discriminator 12
 836 0178 002B     		cmp	r3, #0
 837 017a B8BF     		it	lt
 838 017c 5B42     		rsblt	r3, r3, #0
 202:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, s_route_ref, INT32_TRIG_FRAC);
 839              		.loc 1 202 0 discriminator 12
 840 017e 5943     		muls	r1, r3, r1
 199:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   s_route_ref = abs(s_route_ref);
 841              		.loc 1 199 0 discriminator 12
 842 0180 2B60     		str	r3, [r5, #0]
 203:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Compute maximum speed*/
 204:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, c_route_ref, INT32_TRIG_FRAC);
 843              		.loc 1 204 0 discriminator 12
 844 0182 4FF42075 		mov	r5, #640
 845 0186 6E43     		muls	r6, r5, r6
 205:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, s_route_ref, INT32_TRIG_FRAC);
 846              		.loc 1 205 0 discriminator 12
 847 0188 6B43     		muls	r3, r5, r3
 201:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, c_route_ref, INT32_TRIG_FRAC);
 848              		.loc 1 201 0 discriminator 12
 849 018a 2C4C     		ldr	r4, .L85+32
 850 018c 8013     		asrs	r0, r0, #14
 202:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, s_route_ref, INT32_TRIG_FRAC);
 851              		.loc 1 202 0 discriminator 12
 852 018e 8913     		asrs	r1, r1, #14
 201:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, c_route_ref, INT32_TRIG_FRAC);
 853              		.loc 1 201 0 discriminator 12
 854 0190 2060     		str	r0, [r4, #0]
 202:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_accel_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_ACCEL, s_route_ref, INT32_TRIG_FRAC);
 855              		.loc 1 202 0 discriminator 12
 856 0192 6160     		str	r1, [r4, #4]
 206:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* restore gh_speed_ref range (Q14.17) */
 207:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_max_speed_ref, gh_max_speed_ref, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC
 208:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 209:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Saturate accelerations */
 210:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_accel_ref.x <= -gh_max_accel_ref.x) {
 857              		.loc 1 210 0 discriminator 12
 858 0194 234C     		ldr	r4, .L85+8
 204:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.x = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, c_route_ref, INT32_TRIG_FRAC);
 859              		.loc 1 204 0 discriminator 12
 860 0196 B213     		asrs	r2, r6, #14
 205:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   gh_max_speed_ref.y = INT_MULT_RSHIFT((int32_t)GH_MAX_SPEED, s_route_ref, INT32_TRIG_FRAC);
 861              		.loc 1 205 0 discriminator 12
 862 0198 9B13     		asrs	r3, r3, #14
 207:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_max_speed_ref, gh_max_speed_ref, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC
 863              		.loc 1 207 0 discriminator 12
 864 019a 294E     		ldr	r6, .L85+36
 865 019c 9202     		lsls	r2, r2, #10
 866 019e 9B02     		lsls	r3, r3, #10
 867              		.loc 1 210 0 discriminator 12
 868 01a0 2568     		ldr	r5, [r4, #0]
 207:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   INT32_VECT2_LSHIFT(gh_max_speed_ref, gh_max_speed_ref, (GH_SPEED_REF_FRAC - GH_MAX_SPEED_REF_FRAC
 869              		.loc 1 207 0 discriminator 12
 870 01a2 3260     		str	r2, [r6, #0]
 871 01a4 7360     		str	r3, [r6, #4]
 872              		.loc 1 210 0 discriminator 12
 873 01a6 4642     		negs	r6, r0
 874 01a8 B542     		cmp	r5, r6
 875 01aa 01DC     		bgt	.L65
 211:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.x = -gh_max_accel_ref.x;
 876              		.loc 1 211 0
 877 01ac 2660     		str	r6, [r4, #0]
 878 01ae 02E0     		b	.L66
 879              	.L65:
 212:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 213:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_accel_ref.x >=  gh_max_accel_ref.x) {
 880              		.loc 1 213 0
 881 01b0 8542     		cmp	r5, r0
 214:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.x =  gh_max_accel_ref.x;
 882              		.loc 1 214 0
 883 01b2 A8BF     		it	ge
 884 01b4 2060     		strge	r0, [r4, #0]
 885              	.L66:
 215:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 216:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_accel_ref.y <= -gh_max_accel_ref.y) {
 886              		.loc 1 216 0
 887 01b6 6468     		ldr	r4, [r4, #4]
 888 01b8 4D42     		negs	r5, r1
 889 01ba AC42     		cmp	r4, r5
 890 01bc 1948     		ldr	r0, .L85+8
 891 01be 01DC     		bgt	.L67
 217:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.y = -gh_max_accel_ref.y;
 892              		.loc 1 217 0
 893 01c0 4560     		str	r5, [r0, #4]
 894 01c2 02E0     		b	.L68
 895              	.L67:
 218:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 219:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_accel_ref.y >= gh_max_accel_ref.y) {
 896              		.loc 1 219 0
 897 01c4 8C42     		cmp	r4, r1
 220:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_accel_ref.y = gh_max_accel_ref.y;
 898              		.loc 1 220 0
 899 01c6 A8BF     		it	ge
 900 01c8 4160     		strge	r1, [r0, #4]
 901              	.L68:
 221:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 222:firmwares/rotorcraft/guidance/guidance_h_ref.c **** 
 223:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   /* Saturate speed and adjust acceleration accordingly */
 224:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_speed_ref.x <= -gh_max_speed_ref.x) {
 902              		.loc 1 224 0
 903 01ca 1449     		ldr	r1, .L85
 904 01cc 5442     		negs	r4, r2
 905 01ce 0868     		ldr	r0, [r1, #0]
 906 01d0 A042     		cmp	r0, r4
 907 01d2 05DC     		bgt	.L69
 225:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.x = -gh_max_speed_ref.x;
 226:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.x < 0)
 908              		.loc 1 226 0
 909 01d4 134A     		ldr	r2, .L85+8
 225:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.x = -gh_max_speed_ref.x;
 910              		.loc 1 225 0
 911 01d6 0C60     		str	r4, [r1, #0]
 912              		.loc 1 226 0
 913 01d8 1068     		ldr	r0, [r2, #0]
 914 01da 0028     		cmp	r0, #0
 915 01dc 09DA     		bge	.L71
 916 01de 06E0     		b	.L81
 917              	.L69:
 227:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.x = 0;
 228:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 229:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_speed_ref.x >=  gh_max_speed_ref.x) {
 918              		.loc 1 229 0
 919 01e0 9042     		cmp	r0, r2
 920 01e2 06DB     		blt	.L71
 230:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.x =  gh_max_speed_ref.x;
 921              		.loc 1 230 0
 922 01e4 0A60     		str	r2, [r1, #0]
 231:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.x > 0)
 923              		.loc 1 231 0
 924 01e6 0F4A     		ldr	r2, .L85+8
 925 01e8 1068     		ldr	r0, [r2, #0]
 926 01ea 0028     		cmp	r0, #0
 927 01ec 01DD     		ble	.L71
 928              	.L81:
 232:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.x = 0;
 929              		.loc 1 232 0
 930 01ee 0020     		movs	r0, #0
 931 01f0 1060     		str	r0, [r2, #0]
 932              	.L71:
 233:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 234:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   if (gh_speed_ref.y <= -gh_max_speed_ref.y) {
 933              		.loc 1 234 0
 934 01f2 4968     		ldr	r1, [r1, #4]
 935 01f4 5842     		negs	r0, r3
 936 01f6 8142     		cmp	r1, r0
 937 01f8 084A     		ldr	r2, .L85
 938 01fa 05DC     		bgt	.L73
 235:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.y = -gh_max_speed_ref.y;
 236:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.y < 0)
 939              		.loc 1 236 0
 940 01fc 094B     		ldr	r3, .L85+8
 235:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.y = -gh_max_speed_ref.y;
 941              		.loc 1 235 0
 942 01fe 5060     		str	r0, [r2, #4]
 943              		.loc 1 236 0
 944 0200 5968     		ldr	r1, [r3, #4]
 945 0202 0029     		cmp	r1, #0
 946 0204 09DA     		bge	.L46
 947 0206 06E0     		b	.L82
 948              	.L73:
 237:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.y = 0;
 238:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 239:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   else if (gh_speed_ref.y >= gh_max_speed_ref.y) {
 949              		.loc 1 239 0
 950 0208 9942     		cmp	r1, r3
 951 020a 06DB     		blt	.L46
 240:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     gh_speed_ref.y = gh_max_speed_ref.y;
 952              		.loc 1 240 0
 953 020c 5360     		str	r3, [r2, #4]
 241:firmwares/rotorcraft/guidance/guidance_h_ref.c ****     if (gh_accel_ref.y > 0)
 954              		.loc 1 241 0
 955 020e 054B     		ldr	r3, .L85+8
 956 0210 5A68     		ldr	r2, [r3, #4]
 957 0212 002A     		cmp	r2, #0
 958 0214 01DD     		ble	.L46
 959              	.L82:
 242:firmwares/rotorcraft/guidance/guidance_h_ref.c ****       gh_accel_ref.y = 0;
 960              		.loc 1 242 0
 961 0216 0020     		movs	r0, #0
 962 0218 5860     		str	r0, [r3, #4]
 963              	.L46:
 243:firmwares/rotorcraft/guidance/guidance_h_ref.c ****   }
 244:firmwares/rotorcraft/guidance/guidance_h_ref.c **** }
 964              		.loc 1 244 0
 965 021a FEBD     		pop	{r1, r2, r3, r4, r5, r6, r7, pc}
 966              	.L86:
 967              		.align	2
 968              	.L85:
 969 021c 00000000 		.word	.LANCHOR1
 970 0220 00000000 		.word	.LANCHOR0
 971 0224 00000000 		.word	.LANCHOR2
 972 0228 00000000 		.word	.LANCHOR3
 973 022c BDCDFFFF 		.word	-12867
 974 0230 00000000 		.word	.LANCHOR4
 975 0234 00000000 		.word	pprz_trig_int
 976 0238 00000000 		.word	.LANCHOR5
 977 023c 00000000 		.word	.LANCHOR6
 978 0240 00000000 		.word	.LANCHOR7
 979              		.cfi_endproc
 980              	.LFE2:
 982              		.global	gh_pos_ref
 983              		.global	gh_speed_ref
 984              		.global	gh_accel_ref
 985              		.section	.bss.s_route_ref,"aw",%nobits
 986              		.align	2
 987              		.set	.LANCHOR4,. + 0
 990              	s_route_ref:
 991 0000 00000000 		.space	4
 992              		.section	.bss.gh_speed_ref,"aw",%nobits
 993              		.align	2
 994              		.set	.LANCHOR1,. + 0
 997              	gh_speed_ref:
 998 0000 00000000 		.space	8
 998      00000000 
 999              		.section	.bss.gh_pos_ref,"aw",%nobits
 1000              		.align	3
 1001              		.set	.LANCHOR0,. + 0
 1004              	gh_pos_ref:
 1005 0000 00000000 		.space	16
 1005      00000000 
 1005      00000000 
 1005      00000000 
 1006              		.section	.bss.gh_max_accel_ref,"aw",%nobits
 1007              		.align	2
 1008              		.set	.LANCHOR6,. + 0
 1011              	gh_max_accel_ref:
 1012 0000 00000000 		.space	8
 1012      00000000 
 1013              		.section	.bss.c_route_ref,"aw",%nobits
 1014              		.align	2
 1015              		.set	.LANCHOR5,. + 0
 1018              	c_route_ref:
 1019 0000 00000000 		.space	4
 1020              		.section	.bss.route_ref,"aw",%nobits
 1021              		.align	2
 1022              		.set	.LANCHOR3,. + 0
 1025              	route_ref:
 1026 0000 00000000 		.space	4
 1027              		.section	.bss.gh_accel_ref,"aw",%nobits
 1028              		.align	2
 1029              		.set	.LANCHOR2,. + 0
 1032              	gh_accel_ref:
 1033 0000 00000000 		.space	8
 1033      00000000 
 1034              		.section	.bss.gh_max_speed_ref,"aw",%nobits
 1035              		.align	2
 1036              		.set	.LANCHOR7,. + 0
 1039              	gh_max_speed_ref:
 1040 0000 00000000 		.space	8
 1040      00000000 
 1041              		.text
 1042              	.Letext0:
 1043              		.file 2 "/opt/local/bin/../lib/gcc/arm-none-eabi/4.7.3/../../../../arm-none-eabi/include/stdint.h"
 1044              		.file 3 "./math/pprz_algebra_int.h"
 1045              		.file 4 "./math/pprz_trig_int.h"
 1046              		.file 5 "/opt/local/bin/../lib/gcc/arm-none-eabi/4.7.3/../../../../arm-none-eabi/include/math.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 guidance_h_ref.c
/var/tmp//ccJ6BsDY.s:19     .text.gh_set_ref:0000000000000000 $t
/var/tmp//ccJ6BsDY.s:24     .text.gh_set_ref:0000000000000000 gh_set_ref
/var/tmp//ccJ6BsDY.s:95     .text.gh_set_ref:000000000000004c $d
/var/tmp//ccJ6BsDY.s:108    .text.gh_update_ref_from_pos_sp:0000000000000000 $t
/var/tmp//ccJ6BsDY.s:113    .text.gh_update_ref_from_pos_sp:0000000000000000 gh_update_ref_from_pos_sp
/var/tmp//ccJ6BsDY.s:546    .text.gh_update_ref_from_pos_sp:0000000000000260 $d
/var/tmp//ccJ6BsDY.s:564    .text.gh_update_ref_from_speed_sp:0000000000000000 $t
/var/tmp//ccJ6BsDY.s:569    .text.gh_update_ref_from_speed_sp:0000000000000000 gh_update_ref_from_speed_sp
/var/tmp//ccJ6BsDY.s:969    .text.gh_update_ref_from_speed_sp:000000000000021c $d
/var/tmp//ccJ6BsDY.s:1004   .bss.gh_pos_ref:0000000000000000 gh_pos_ref
/var/tmp//ccJ6BsDY.s:997    .bss.gh_speed_ref:0000000000000000 gh_speed_ref
/var/tmp//ccJ6BsDY.s:1032   .bss.gh_accel_ref:0000000000000000 gh_accel_ref
/var/tmp//ccJ6BsDY.s:986    .bss.s_route_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:990    .bss.s_route_ref:0000000000000000 s_route_ref
/var/tmp//ccJ6BsDY.s:993    .bss.gh_speed_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1000   .bss.gh_pos_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1007   .bss.gh_max_accel_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1011   .bss.gh_max_accel_ref:0000000000000000 gh_max_accel_ref
/var/tmp//ccJ6BsDY.s:1014   .bss.c_route_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1018   .bss.c_route_ref:0000000000000000 c_route_ref
/var/tmp//ccJ6BsDY.s:1021   .bss.route_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1025   .bss.route_ref:0000000000000000 route_ref
/var/tmp//ccJ6BsDY.s:1028   .bss.gh_accel_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1035   .bss.gh_max_speed_ref:0000000000000000 $d
/var/tmp//ccJ6BsDY.s:1039   .bss.gh_max_speed_ref:0000000000000000 gh_max_speed_ref
                     .debug_frame:0000000000000010 $d

UNDEFINED SYMBOLS
__aeabi_i2d
__aeabi_dmul
__aeabi_d2iz
__aeabi_i2f
__aeabi_fmul
__aeabi_f2iz
atan2f
pprz_trig_int
